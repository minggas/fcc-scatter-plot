"use strict";var end="https://raw.githubusercontent.com/FreeCodeCamp/ProjectReferenceData/master/cyclist-data.json",margin={top:80,right:30,bottom:40,left:80},w=920-margin.left-margin.right,h=630-margin.top-margin.bottom,legendColor=d3.scaleOrdinal(d3.schemeSet1);String.prototype.ordinalNumber=function(){return"1"===this[this.length-1]?this+"st":"2"===this[this.length-1]?this+"nd":"3"===this[this.length-1]?this+"rd":this+"th"};var tooltip=d3.select(".container").append("div").attr("id","tooltip").style("opacity",0),svgContainer=d3.select(".container").append("svg").attr("class","chart").attr("width",w+margin.left+margin.right).attr("height",h+margin.top+margin.bottom).append("g").attr("transform","translate("+margin.left+","+margin.top+")");d3.json(end).then(function(t){t.forEach(function(t){var e=t.Time.split(":");t.MinTime=t.Time,t.Time=new Date(Date.UTC(1970,0,1,0,e[0],e[1]))});var e=d3.scaleLinear().domain([d3.min(t,function(t){return t.Year-1}),d3.max(t,function(t){return t.Year+1})]).range([0,w]),a=d3.scaleTime().domain(d3.extent(t,function(t){return t.Time})).range([0,h]),n=d3.timeFormat("%M:%S"),r=d3.axisBottom(e).tickFormat(d3.format("d")),i=d3.axisLeft(a).tickFormat(n);svgContainer.append("g").attr("class","x axis").attr("id","x-axis").attr("transform","translate(0,"+h+")").call(r).append("text").attr("class","x-axis-label").attr("x",w).attr("y",-6).style("text-anchor","end").text("Year"),svgContainer.append("g").attr("class","y axis").attr("id","y-axis").call(i),svgContainer.append("text").attr("class","label").attr("transform","rotate(-90)").attr("x",-150).attr("y",-44).style("font-size",18).text("Time in Minutes"),svgContainer.selectAll(".dot").data(t).enter().append("svg:a").attr("xlink:href",function(t){return t.URL}).attr("target","_blank").append("circle").attr("class","dot").attr("data-xvalue",function(t,e){return parseInt(t.Year)}).attr("data-yvalue",function(t,e){return t.Time.toISOString()}).attr("cx",function(t){return e(t.Year)}).attr("cy",function(t){return a(t.Time)}).attr("r",5).style("fill",function(t){return legendColor(""!==t.Doping)}).on("mouseover",function(t,e){tooltip.transition().duration(200).style("opacity",.8),tooltip.html(t.Name+": "+t.Nationality+" - "+t.Place.toString().ordinalNumber()+" Place<br/>Year: "+t.Year+" Time: "+t.MinTime+"<br/><br/>"+t.Doping).attr("data-year",t.Year).style("left",d3.event.pageX+15+"px").style("top",d3.event.pageY-5+"px")}).on("mouseout",function(t){tooltip.transition().duration(200).style("opacity",0)}),svgContainer.append("text").attr("id","title").attr("x",w/2).attr("y",-margin.top/2).attr("text-anchor","middle").style("font-size","2rem").text("Doping in Bycicle Racing"),svgContainer.append("text").attr("x",w/2).attr("y",-margin.top/2+25).attr("text-anchor","middle").style("font-size","1rem").text("35 Fastest Time up Alpe d'Huez");var o=svgContainer.selectAll("legend").data(legendColor.domain()).enter().append("g").attr("id","legend").attr("transform",function(t,e){return"translate(0,"+(h/2-20*e)+")"});o.append("rect").attr("x",w-18).attr("width",18).attr("height",18).style("fill",legendColor),o.append("text").attr("x",w-24).attr("y",9).attr("dy",".35em").style("text-anchor","end").text(function(t){return t?"Riders with doping allegations":"No doping allegations"})}).catch(function(t){alert(t)});
